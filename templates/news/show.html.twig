{% extends 'base.html.twig' %}

{% block stylesheets %}
	{{encore_entry_link_tags('newStyle')}}
{% endblock %}

{% block title %}
	{{ news.title }}
{% endblock %}

{% block body %}
	<div class="slide" id="news">
		<div class="heading" style="background-image:url('/uploads/{{news.cover}}')">
			<div class="heading_title">
				<h5 class="display-xl text-uppercase stratos">{{news.status}}
					:</h5>
				<h3 class="display-xl text-uppercase stratos">{{news.title}}</h3>
			</div>
		</div>
		<div class="wrapper" id="wrapperNews">
			<div class="row">
				<div class="col-md-6" id="blockNews">
					<div class="content_news">
					    {% if (app.user and app.user == news.author) or is_granted('ROLE_ADMIN') %}
						<div class="d-flex">
							<a href="{{path('news_edit', {'slug':news.slug})}}" class="btn btn-warning m-2">Modification de l'annonce</a>
								<button type="button" class="btn btn-danger m-2" data-bs-toggle="modal" data-bs-target="#deleteModal">Supprimer la news</button>
						</div>
            {% endif %}
						<p class="text-xl stratos text-uppercase">{{news.subtitle}}</p>
						<p class="content_text text-md hero">{{ news.text | striptags | nl2br | raw }}</p>
						<div class="author">
							<p class="text-md hero text-white">Écrit par
								<a href="{{ path('user_show', {'slug': news.author.slug}) }}" class="">{{ news.author.fullName}}</a>
								le
								{{ news.createdAt | date('d/m/Y') }}</p>
						</div>
					</div>

					<div class="actionsNews">
						<!-- templates/news/show.html.twig -->

						{% if previousNews %}
							<a href="{{ path('news_show', {slug: previousNews.slug}) }}" class="previousNews text-md hero"><i class="fa-solid fa-arrow-left"></i> Aller à l'article précédent</a>
						{% endif %}

						{% if nextNews %}
							<a href="{{ path('news_show', {slug: nextNews.slug}) }}"class="nextNews text-md hero">Aller à l'article suivant<i class="fa-solid fa-arrow-right"></i></a>
						{% endif %}

					</div>
				</div>
				<div class="col-md-6 d-flex  justify-content-center align-items-start">
					{% for team in news.team %}
						<img src="/uploads/{{ team.logoBackground}}" alt="Logo de l'équipe {{ team.name }}" class=" d-block img-fluid logoTeam">
					{% endfor %}

				</div>
			</div>
			<div class="container_comment">
				<h2 class="display-xl kizard">Commentaires</h2>
				  <hr>
                {% if news.comments | length > 0 %}
                {% for comment in news.comments %}
				<div class="cardComments col-md-7 my-3">
					<div class="headingComment d-flex justify-content-between align-items-center">
						<p class="text-md hero fw-bold  align-items-center">{{comment.author.fullName}} <span class="fw-normal"> a dit le <span class="fw-bold">{{comment.createdAt | date('d-m-Y')}}</span></span></p>
						{% include "partials/rating.html.twig" with {'rating': comment.rating} %}  
					</div>
					<div class="contentCard d-flex gap-5 text-md hero">
						{{comment.content | nl2br | raw}}
						{% if comment.author.picture %}
						<img src="/uploads/{{comment.author.picture}}" alt="Photo de profil de {{comment.author.fullName}}" class="img-fluid newsPP"width="50px" height="50px">
						{% endif %}
						
					</div>                      


				</div>
                    
                {% endfor %}
                {% else %}
                    <h2>Cette annonce n'a pas encore reçu de commentaire...</h2>
                {% endif %}

			  {# gestion des commentaire #}
			</div>


              
		</div>
		
	</div>

	
		<!-- Modal de suppression -->
	<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="deleteModalLabel">Supprimer la news</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Êtes-vous sûr de vouloir supprimer cette news ?
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<a href="{{ path('news_delete', {'slug': news.slug}) }}" class="btn btn-danger">Supprimer</a>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
